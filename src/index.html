<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Mock Broy</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg-dark: #1e293b;
        --bg-light: #334155;
        --border-color: #475569;
        --text-primary: #cbd5e1;
        --text-secondary: #94a3b8;
        --accent-blue: #3b82f6;
        --accent-blue-hover: #2563eb;
        --accent-red: #ef4444;
        --accent-red-hover: #dc2626;
        --status-green: #22c55e;
        --status-yellow: #eab308;
        --status-red: #ef4444;
      }

      body {
        font-family: "Inter", sans-serif;
        background-color: var(--bg-dark);
        color: var(--text-primary);
        margin: 0;
        padding: 24px;
        font-size: 14px;
      }

      .container {
        max-width: 768px;
        margin: auto;
      }

      header h1 {
        color: var(--text-primary);
        font-size: 24px;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      header p {
        background-color: transparent;
        padding: 0;
        margin-top: -12px;
        color: var(--text-secondary);
      }

      .card {
        background-color: var(--bg-light);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 20px;
        margin-top: 24px;
      }

      .file-input {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 16px;
      }
      .file-input label {
        font-weight: 500;
      }
      .file-path {
        color: var(--text-secondary);
        font-size: 12px;
        text-align: right;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        margin-left: 16px;
      }

      button {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background-color: var(--accent-blue);
        color: white;
        border: none;
        padding: 10px 16px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: background-color 0.2s;
      }
      button:hover {
        background-color: var(--accent-blue-hover);
      }
      button:disabled {
        background-color: #475569;
        cursor: not-allowed;
      }

      #stopBtn {
        background-color: var(--accent-red);
      }
      #stopBtn:hover {
        background-color: var(--accent-red-hover);
      }

      .controls {
        display: flex;
        gap: 12px;
      }

      #port-input {
        background-color: var(--bg-dark);
        border: 1px solid var(--border-color);
        color: var(--text-primary);
        border-radius: 6px;
        padding: 10px;
        width: 80px;
      }

      #status-container {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px;
        border-radius: 6px;
        margin-top: 16px;
        transition: background-color 0.3s;
      }
      #status-container.running {
        background-color: rgba(34, 197, 94, 0.1);
        color: var(--status-green);
      }
      #status-container.stopped {
        background-color: rgba(239, 68, 68, 0.1);
        color: var(--status-red);
      }
      #status-container.loading {
        background-color: rgba(234, 179, 8, 0.1);
        color: var(--status-yellow);
      }

      .spinner {
        width: 16px;
        height: 16px;
        border: 2px solid currentColor;
        border-bottom-color: transparent;
        border-radius: 50%;
        display: inline-block;
        box-sizing: border-box;
        animation: rotation 1s linear infinite;
      }
      @keyframes rotation {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      #endpoints-container {
        margin-top: 24px;
      }
      #endpoints-container h3 {
        font-size: 16px;
        color: var(--text-primary);
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 8px;
      }
      .endpoint-control {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 0;
        border-bottom: 1px solid var(--border-color);
      }
      .endpoint-control:last-child {
        border-bottom: none;
      }
      .endpoint-control label {
        font-weight: 500;
      }
      .endpoint-control select {
        background-color: var(--bg-dark);
        border: 1px solid var(--border-color);
        color: var(--text-primary);
        border-radius: 6px;
        padding: 8px;
      }
      /* Hierarki folder endpoint */
      .folder-summary {
        font-weight: 700;
        font-size: 15px;
        cursor: pointer;
        padding: 8px 0;
        list-style: none;
      }
      .folder-summary::-webkit-details-marker {
        display: none;
      }
      .folder-summary::before {
        content: 'üìÇ';
        margin-right: 8px;
      }
      details[open] > summary.folder-summary::before {
        content: 'üìÅ';
      }
      .folder-content {
        padding-left: 24px;
        border-left: 1px solid var(--border-color);
      }
      .method-label {
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 700;
        margin-right: 8px;
        color: white;
      }
      .method-label.GET { background-color: #3b82f6; }
      .method-label.POST { background-color: #22c55e; }
      .method-label.PUT { background-color: #f97316; }
      .method-label.PATCH { background-color: #eab308; }
      .method-label.DELETE { background-color: #ef4444; }

      #log-container {
        background-color: #111827;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        margin-top: 24px;
        font-family: monospace;
      }
      #log-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 16px;
        border-bottom: 1px solid var(--border-color);
      }
      #log-body {
        height: 200px;
        overflow-y: auto;
        padding: 12px 16px;
        font-size: 13px;
        display: flex;
        flex-direction: column-reverse; /* Log baru muncul di atas */
      }
      .log-entry { white-space: pre-wrap; margin-bottom: 4px; }
      .log-code-200 { color: var(--status-green); }
      .log-code-400, .log-code-404 { color: #eab308; }
      .log-code-500 { color: var(--status-red); }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>
          <svg
            width="28"
            height="28"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M12.39 20.87a.696.696 0 0 1-.78 0C9.764 19.637 2 14.151 2 8.973c0-4.08 3.06-7.484 7-7.484a6.953 6.953 0 0 1 6.5 4.017A6.953 6.953 0 0 1 22 8.973c0 5.178-7.764 10.664-9.61 11.897Z"
              fill="#3b82f6"
            />
          </svg>
          Mock Broy
        </h1>
        <p>Generate mock server dari file Postman secara instan.</p>
      </header>

      <div class="card">
        <div class="file-input">
          <label>File Collection (.json)</label>
          <button id="collectionBtn">Pilih File</button>
        </div>
        <span id="collectionPath" class="file-path"
          >Tidak ada file dipilih</span
        >
        <hr
          style="
            border-color: var(--border-color);
            margin: 16px 0;
            border-style: solid;
            border-width: 1px 0 0 0;
          "
        />
        <div class="file-input">
          <label>File Environment (.json)</label>
          <button id="envBtn">Pilih File</button>
        </div>
        <span id="envPath" class="file-path">Tidak ada file dipilih</span>
      </div>

      <div class="card">
        <div class="controls">
          <button id="startBtn">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path d="M7 6v12l10-6z" fill="currentColor" />
            </svg>
            Start Server
          </button>
          <button id="stopBtn">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path d="M8 8h8v8H8z" fill="currentColor" />
            </svg>
            Stop Server
          </button>
          <input type="number" id="port-input" value="3005" />
        </div>
        <div id="status-container" class="stopped">
          <span id="status-icon">‚èπÔ∏è</span>
          <p id="status" style="padding: 0; background: none">
            Server dihentikan.
          </p>
        </div>
      </div>

      <div id="endpoints-container"></div>

      <div id="log-container-wrapper" style="display: none;">
        <div id="log-container">
          <div id="log-header">
            <h3>Real-time Logs</h3>
            <button id="clearLogBtn" style="font-size: 12px; padding: 6px 10px;">Clear Log</button>
          </div>
          <div id="log-body"></div>
        </div>
      </div>
    </div>

    <script src="./renderer.js"></script>
  </body>
</html>
